<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=0.9*device-width">
    <title>LinearAlgebraWork9</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function () {
    sagecell.makeSagecell({inputLocation:'div.linked_sage',linked:true,evalButtonText:'Run Linked Sage Cells'});
    sagecell.makeSagecell({inputLocation:'div.linked_python',linked:true,evalButtonText:'Run Linked Python Cells'});
    sagecell.makeSagecell({inputLocation:'div.linked_r',linked:true,evalButtonText:'Run Linked R Cells'});
    sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run'});
    sagecell.makeSagecell({inputLocation:'div.sage_html',evalButtonText:'Run HTML'});
    });
    </script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron');
  h1, h2 {color:#3636ff; font-family:'Orbitron'; text-shadow:5px 5px 5px #aaa;}
  p, a {color:darkblue; font-size:110%; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:26em;}
  </style>  
  <body>
    <h1>&#x1F4D1; &nbsp; Линейная алгебра. Практическая работа №9</h1>
    <h1>Плоскости</h1>
    <h2>1. Уравнения</h2>

Общий вид

<p>$\pi: \ a * x + b * y + c * z + d = 0$</p>
<p>$\overrightarrow{n}\{a;b;c\} \perp \pi$</p>

Проходящая через точку $A_0(x_0;y_0;z_0)$ и перпендикулярная $\overrightarrow{n}\{a;b;c\}$

<p>$\pi: \ a * (x - x_0) + b * (y - y_0) + c * (z -z_0) = 0$</p>

Через три точки $A_1 (x_1;y_1;z_1), A_2 (x_2,y_2,z_2), A_3 (x_3,y_3,z_3)$

<p>$\begin {vmatrix} x - x_1 & y - y_1 & z - z_1 \\ x_2 - x_1 & y_2 - y_1 & z_2 - z_1 \\ x_3 - x_1 & y_3 - y_1 & z_3 - z_1 \end{vmatrix} = 0$</p>

В отрезках

<p>$\pi: \frac{x}{\alpha} + \frac{x}{\beta} + \frac{z}{\gamma} = 1$</p>
<p>$\alpha = -\frac{d}{a}, \ \beta = -\frac{d}{b}, \ \gamma = -\frac{d}{c}$</p>

Параметрические уравнения плоскости

<p>$\pi: \begin {cases} x = x_0 + p_1 * t_1 + p_2 * t_2 \\ y = y_0 + q_1 * t_1 + q_2 * t_2 \\ z = z_0 + r_1 * t_1 + r_2 * t_2 \end {cases}, \ t_1, t_2 \in \mathbb{R}$</p>
<p>$\overrightarrow{s_1}\{p_1;q_1;r_1\}, \ \overrightarrow{s_2}\{p_2;q_2;r_2\} \parallel \pi, \ A_0(x_0;y_0;z_0) \in \pi$</p>

Нормальное уравнение плоскости

$P$ - проекция начала координат $O(0;0;0)$ на плоскость $\pi$

<p>$ |\overrightarrow{OP}| = p, \ \angle(\overrightarrow{OP}, \overrightarrow{OX}) = \alpha, \ \angle(\overrightarrow{OP}, \overrightarrow{OY}) = \beta, \ \angle(\overrightarrow{OP}, \overrightarrow{OZ}) = \gamma, \ $</p>
<p>$\pi: x \cdot \cos \alpha + y \cdot \cos \beta + z \cdot \cos \gamma = p$</p>
<p>$\cos^2 \alpha + \cos^2 \beta + \cos^2 \gamma = 1$</p>
    <p>Активируйте этот код перед использованием любых ячеек Linked Sage Cells</p>
<div class="linked_sage"><script type="text/x-sage">
var('x,y,z,x0,y0,z0,x1,y1,z1,x2,y2,z2,x3,y3,z3')
var('a,b,c,d,p1,q1,r1,p2,q2,r2,t1,t2')
eq=[a*x+b*y+c*z+d==0,
    a*(x-x0)+b*(y-y0)+c*(z-z0)==0,
    Matrix(SR,3,[x-x1,y-y1,z-z1,x2-x1,y2-y1,z2-z1,x3-x1,y3-y1,z3-z1]).det()==0,
    x==x0+p1*t1+p2*t2,y==y0+q1*t1+q2*t2,z==z0+r1*t1+r2*t2]
</script></div>
    <p></p>      
<div class="linked_sage"><script type="text/x-sage">
solutions=[solve([eq[0],a==3,b==-1,c==-1,d==2],a,b,c,d,x,y,z),
           solve([eq[1],a==3,b==2,c==-1,x0==1,y0==-1,z0==2],a,b,c,d,x0,y0,z0,x,y,z),
           solve([eq[2],x1==-3,y1==2,z1==1,x2==1,y2==-3,z2==3,x3==-2,y3==1,z3==1],x1,y1,z1,x2,y2,z2,x3,y3,z3,x,y,z),
           solve([eq[3],eq[4],eq[5],x0==-1,y0==2,z0==-2,p1==2,q1==1,r1==-1,p2==-2,q2==-3,r2==2],x0,y0,z0,p1,q1,r1,p2,q2,r2,t1,t2,x,y,z)]
zsolutions=[solve([eq[0],a==3,b==-1,c==-1,d==2],a,b,c,d,z),
           solve([eq[1],a==3,b==2,c==-1,x0==1,y0==-1,z0==2],a,b,c,d,x0,y0,z0,z),
           solve([eq[2],x1==-3,y1==2,z1==1,x2==1,y2==-3,z2==3,x3==-2,y3==1,z3==1],x1,y1,z1,x2,y2,z2,x3,y3,z3,z),
           solve([eq[3],eq[4],eq[5],x0==-1,y0==2,z0==-2,p1==2,q1==1,r1==-1,p2==-2,q2==-3,r2==2],x0,y0,z0,p1,q1,r1,p2,q2,r2,t1,t2,z)]
solutions[1],zsolutions[1]
</script></div>
    <p></p>
<div class="linked_sage"><script type="text/x-sage">
var('x,y,z'); f=[3*x-y-z+2,3*x+2*y-z+1,-2*x-2*y-z-1]; s=(-2,2) 
colors=['#3636ff','#ff3636','#36ff36']; text_xyz=[(2,2,2),(-2,2,2),(-2,-1,2)] 
labels=['3x-y-z+2=0','3x+2y-z+1=0','-2x-2y-z-1=0']
p=sum([implicit_plot3d(f[i],s,s,s,color=colors[i],plot_points=10,opacity=0.5,mesh=True) for i in [0..2]])
t=sum([text3d(labels[i],text_xyz[i],color=colors[i]) for i in [0..2]])
(p+t).show()
</script></div>
    <p></p>
    <p>Активируйте этот код перед использованием любых ячеек Linked Python Cells</p>
<div class="linked_python"><script type="text/x-sage">
import numpy,sympy,pylab,matplotlib; sympy.init_printing(use_unicode=True)
from mpl_toolkits.mplot3d import Axes3D
import warnings; warnings.simplefilter("ignore",category=RuntimeWarning)

X=numpy.linspace(start=-10,stop=10,num=50); X,Y=numpy.meshgrid(X,X)
def plane1(a,b,c,d,x,y): return -(a*x+b*y+d)/c
def plane2(a,b,c,x0,y0,z0,x,y): return -(a*(x-x0)+b*(y-y0))/c+z0
def plane3(x1,y1,z1,x2,y2,z2,x3,y3,z3,x,y):
    detX=(y2-y1)*(z3-z1)-(y3-y1)*(z2-z1)
    detY=(x2-x1)*(z3-z1)-(x3-x1)*(z2-z1)
    detZ=(x2-x1)*(y3-y1)-(x3-x1)*(y2-y1)
    return z1-((x-x1)*detX-(y-y1)*detY)/detZ
Z=[plane1(3,-1,-1,2,X,Y),plane2(3,2,-1,1,-1,2,X,Y),plane3(-3,2,1,1,-3,3,-2,1,1,X,Y)]
for z in Z: z[z<-10]=numpy.NaN; z[z>10]=numpy.NaN

x,y,z,x0,y0,z0,x1,y1,z1,x2,y2,z2,x3,y3,z3=sympy.symbols('x,y,z,x0,y0,z0,x1,y1,z1,x2,y2,z2,x3,y3,z3')
a,b,c,d,p1,q1,r1,p2,q2,r2,t1,t2=sympy.symbols('a,b,c,d,p1,q1,r1,p2,q2,r2,t1,t2')
eq=[a*x+b*y+c*z+d,
    a*(x-x0)+b*(y-y0)+c*(z-z0),
    sympy.Matrix([[x-x1,y-y1,z-z1],[x2-x1,y2-y1,z2-z1],[x3-x1,y3-y1,z3-z1]]).det(),
    x-x0-p1*t1-p2*t2,y-y0-q1*t1-q2*t2,z-z0-r1*t1-r2*t2]
</script></div>
    <p></p>
<div class="linked_python"><script type="text/x-sage">
solutions=[sympy.solve([eq[0],a-3,b+1,c+1,d-2],a,b,c,d,z),
           sympy.solve([eq[1],a-3,b-2,c+1,x0-1,y0+1,z0-2],a,b,c,x0,y0,z0,z),
           sympy.solve([eq[2],x1+3,y1-2,z1-1,x2-1,y2+3,z2-3,x3+2,y3-1,z3-1],x1,y1,z1,x2,y2,z2,x3,y3,z3,z),
           sympy.solve([eq[3],eq[4],eq[5],x0+1,y0-2,z0+2,p1-2,q1-1,r1+1,p2+2,q2+3,r2-2],x0,y0,z0,p1,q1,r1,p2,q2,r2,x,y,z)]
for s in solutions: sympy.pprint(s); print('\n')
</script></div>
    <p></p>
<div class="linked_python"><script type="text/x-sage">
f=pylab.figure(figsize=(7,7)); ax=f.add_subplot(111,projection='3d')
colors=['#3636ff','#ff3636','#36ff36']; labels=['3x-y-z+2=0','3x+2y-z+1=0','-2x-2y-z-1=0']
for i in range(3): ax.plot_surface(X,Y,Z[i], color=colors[i],alpha=0.5)
fake2Dlines=[matplotlib.lines.Line2D([0],[0],linestyle="none",c=colors[i],marker='d') for i in range(3)]
ax.set_xlim(-10,10); ax.set_ylim(-10,10); ax.set_zlim(-10,10)
ax.legend(fake2Dlines,labels,loc=9); pylab.show()
</script></div>
    <p></p>
    <p>Активируйте этот код перед использованием любых ячеек Linked R Cells</p>
<div class="linked_r"><script type="text/x-sage">
%%r
X <- Y <- seq(from=-10,to=11,by=1)
plane1 <- function(a,b,c,d,x,y) {-(a*x+b*y+d)/c}
plane2 <- function(a,b,c,x0,y0,z0,x,y) {-(a*(x-x0)+b*(y-y0))/c+z0}
plane3 <- function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x,y){
    detX <- (y2-y1)*(z3-z1)-(y3-y1)*(z2-z1)
    detY <- (x2-x1)*(z3-z1)-(x3-x1)*(z2-z1)
    detZ <- (x2-x1)*(y3-y1)-(x3-x1)*(y2-y1)    
    z1-((x-x1)*detX-(y-y1)*detY)/detZ
}
Z1 <- plane1(3,-1,-1,2,X,Y); Z2 <- plane2(3,2,-1,1,-1,2,X,Y); Z3 <- plane3(-3,2,1,1,-3,3,-2,1,1,X,Y)
library(grDevices); library(Matrix)
</script></div>
    <p></p>
<div class="linked_r"><script type="text/x-sage">
%%r
svg(filename="Rplots.svg",width=7,height=7,pointsize=12,onefile=TRUE,
    family="sans",bg="white",antialias = c("default","none","gray","subpixel"))
cols <- c('#3636ff','#ff3636','#36ff36'); labs <- c('3x-y-z+2=0','3x+2y-z+1=0','-2x-2y-z-1=0')
plot(X,Z1,col=cols[1],type='l',lwd=3,xlim=c(-10,10),ylim=c(-10,10),xlab='x (y=0)',ylab='z')
lines(X,Z2,col=cols[2],lwd=3); lines(X,Z3,col=cols[3],lwd=3)
legend(4,-4,title='y=0',labs,col=cols,lwd=3); grid(); dev.off()
</script></div>      
    <p></p>
    <h2>2. Взаимное расположение точек, прямых и плоскостей</h2>
<div class="linked_sage"><script type="text/x-sage">

</script></div>
    <p></p>
<div class="linked_python"><script type="text/x-sage">

</script></div>
    <p></p>  
<div class="linked_r"><script type="text/x-sage">
%%r

</script></div>
    <p></p> 
    <h2>3. Задание</h2>
    <p></p>
Создать массив координат 4 точек так, чтобы они не принадлежали одной плоскости.
<br/><br/>
Составить уравнения в общем виде 2 плоскостей, содержащих по крайней мере 3 точки из созданного массива, используя SageMath, Numpy, SymPy или R.  
    <p></p>
<div class="linked_sage"><script type="text/x-sage">

</script></div>
    <p></p>
<div class="linked_python"><script type="text/x-sage">

</script></div>
    <p></p>  
<div class="linked_r"><script type="text/x-sage">
%%r

</script></div>
    <p></p> 
    <h2>4. Отдельная ячейка для дополнительных экспериментов</h2>      
<div class="sage"><script type="text/x-sage">

</script></div>
    <p></p>
  </body>
</html> 