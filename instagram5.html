<!DOCTYPE HTML>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width'>
    <title>Instagram_Posts5</title>
    <script src='https://sagecell.sagemath.org/static/embedded_sagecell.js'></script>
    <script>$(function (){
    sagecell.makeSagecell({inputLocation:'div.linked',linked:true,evalButtonText:'Run Linked Cells'});
    sagecell.makeSagecell({inputLocation:'div.sage_html',evalButtonText:'Run HTML'});  
    sagecell.makeSagecell({inputLocation:'div.sage_js',evalButtonText:'Run JavaScript'});
    sagecell.makeSagecell({inputLocation:'div.sage_r',evalButtonText:'Run R'});  
    sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run'});});
    </script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron');
  h1,h2 {color:#3636ff; font-family:Orbitron; text-shadow:5px 5px 5px #aaa;}
  p,a {color:darkblue; font-size:120%; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:60em;}
  body {margin:5px 5px 5px 15px;}      
  </style>  
  <body>
<script src='https://profile.codersrank.io/widget/widget.js'></script>
<codersrank-widget username='olgabelitskaya' layout='vertical'
style='--header-bg-color:#3636ff; font-family:Orbitron;'></codersrank-widget>
    <h1>&#x1F4D1; &nbsp;Instagram Posts. Part 5</h1>
<a href='https://olgabelitskaya.github.io/README.html'>&#x1F300; &nbsp; Home Page &nbsp; &nbsp;</a> 
<a href='https://olgabelitskaya.github.io/instagram4.html'>&#x1F300; &nbsp; Previous &nbsp; &nbsp;</a>
<a href='https://olgabelitskaya.github.io/instagram6.html'>&#x1F300; &nbsp; Next</a><br/>
<a href='https://www.instagram.com/olga.belitskaya/'>&#x1F300; &nbsp; Instagram Posts &nbsp; &nbsp;</a>     
<a href='https://www.pinterest.ru/olga_belitskaya/code-style/'>&#x1F300; &nbsp; Pinterest Posts</a>
    <h1>Do you think it's hard to create your own maps?</h1>
Python Modules &#38; SageMathCell<br/>
<div class='sage'><script type='text/x-sage'>
!python3 -m pip install --upgrade pip \
--user --quiet --no-warn-script-location
!python3 -m pip install geopandas \
--user --quiet --no-warn-script-location
path='/home/sc_work/.sage/local/lib/python3.8/site-packages'
import sys; sys.path.append(path)
import pandas,geopandas,pylab,warnings
warnings.simplefilter('ignore')
pylab.style.use('seaborn-pastel')
fpath='https://olgabelitskaya.github.io/map.geojson'
df=geopandas.GeoDataFrame.from_file(fpath)
ax=df.boundary.plot(figsize=(9,5),markersize=0,
                    linewidth=.1,edgecolor='gray')
footways=df['geometry'][df['highway']=='footway'].loc[2176:]
geopandas.plotting.plot_linestring_collection(
    ax,footways,linewidth=.8,
    color='steelblue',label='footways')
df[df['highway']=='street_lamp'].plot(
    ax=ax,edgecolor='g',markersize=10,label='lamps')
df[df['highway']=='traffic_signals'].plot(
    ax=ax,edgecolor='r',markersize=20,label='traffic signals')
pylab.legend(); pylab.xlim(37.613,37.636)
pylab.ylim(55.752,55.762); pylab.show()
</script></div>
    <h1>It's possible to install TensorFlow</h1>
Python Modules &#38; SageMathCell<br/>     
<div class='linked'><script type='text/x-sage'>
!python3 -m pip install --upgrade pip \
--user --quiet --no-warn-script-location
!python3 -m pip install argon2-cffi \
--user --quiet --no-warn-script-location
!python3 -m pip install --ignore-installed --upgrade tensorflow==2.3.0 \
--user --quiet --no-warn-script-location
path='/home/sc_work/.sage/local/lib/python3.8/site-packages'
import sys; sys.path.append(path)
import tensorflow as tf
</script></div><br/>
<div class='linked'><script type='text/x-sage'>
mnist=tf.keras.datasets.mnist
(x_train,y_train),(x_test,y_test)=mnist.load_data()
x_train,x_test=x_train/255.,x_test/255.
model=tf.keras.models.Sequential([
  tf.keras.layers.Flatten(input_shape=(int(28),int(28))),
  tf.keras.layers.Dense(int(224),activation='relu'),
  tf.keras.layers.Dropout(float(.2)),
  tf.keras.layers.Dense(int(28),activation='relu'),
  tf.keras.layers.Dropout(float(.2)),
  tf.keras.layers.Dense(int(10),activation='softmax')])
model.compile(
    optimizer='nadam',metrics=['accuracy'],
    loss='sparse_categorical_crossentropy')
model.fit(x_train,y_train,epochs=int(3))
model.evaluate(x_test,y_test,verbose=int(1))
</script></div>  
    <h1>Let's have a look at </h1>
    <h1>molecular structures with BioPandas</h1>
Python Modules &#38; SageMathCell<br/>
<div class='sage'><script type='text/x-sage'>
!python3 -m pip install --upgrade pip \
--user --quiet --no-warn-script-location
!python3 -m pip install  biopandas \
--user --quiet --no-warn-script-location
path='/home/sc_work/.sage/local/lib/python3.8/site-packages'
import sys; sys.path.append(path)
f='1b5e_2.mol2'
fpath='https://raw.githubusercontent.com/rasbt/'
fpath+='biopandas/master/docs/tutorials/data/'
import biopandas,numpy,pylab,urllib
pylab.style.use('seaborn-whitegrid')
from biopandas.mol2 import PandasMol2
input_file=urllib.request.urlopen(fpath+f)
output_file=open(f,'wb')
output_file.write(input_file.read())
output_file.close(); input_file.close()
pmol=PandasMol2().read_mol2(f)
colors=pylab.cm.ocean(numpy.linspace(.1,.9,9))
pmol.df['atom_type'].value_counts()\
.plot(kind='bar',color=colors,figsize=(8,6))
pylab.xlabel('atom type')
pylab.ylabel('count'); pylab.show()
</script></div>
    <h1>Feel free to experiment with </h1>
    <h1>stacking classifiers in Mlxtend</h1>
Python Modules &#38; SageMathCell<br/>    
<div class='sage'><script type='text/x-sage'>
!python3 -m pip install --upgrade pip \
--user --quiet --no-warn-script-location
!python3 -m pip install mlxtend \
--user --quiet --no-warn-script-location
path='/home/sc_work/.sage/local/lib/python3.8/site-packages'
import sys; sys.path.append(path)
import numpy,warnings; warnings.simplefilter('ignore')
from sklearn import datasets,model_selection,svm
from mlxtend.classifier import StackingClassifier
from sklearn.linear_model import LogisticRegression,SGDClassifier
from sklearn.linear_model import LogisticRegressionCV 
from sklearn.neighbors import KNeighborsClassifier
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import RandomForestClassifier
digits=datasets.load_digits(); X,y=digits.data,digits.target
clfs=[KNeighborsClassifier(n_neighbors=int(5)),
      RandomForestClassifier(random_state=1),GaussianNB()]
sclf1=StackingClassifier(
    classifiers=clfs,meta_classifier=SGDClassifier(tol=0.001))
sclf2=StackingClassifier(
    classifiers=clfs,meta_classifier=LogisticRegression())
sclf3=StackingClassifier(
    classifiers=clfs,meta_classifier=\
    svm.SVC(gamma='scale',C=10.0,kernel='poly'))
labels=['KNN','Random Forest','Naive Bayes',
        'StackingClassifier - SGD','StackingClassifier - LR',
        'StackingClassifier - SVM']
for clf,label in zip(clfs+[sclf1,sclf2,sclf3],labels):
    scores=model_selection\
    .cross_val_score(clf,X,y,cv=3,scoring='accuracy')
    print('Accuracy: %0.2f (+/- %0.2f) [%s]'\
          %(scores.mean(),scores.std(),label))
</script></div>
    <h1>Do you want to apply </h1>
    <h1>stacking regressors in Mlxtend?</h1>
Python Modules &#38; SageMathCell<br/>       
<div class='sage'><script type='text/x-sage'>
!python3 -m pip install --upgrade pip \
--user --quiet --no-warn-script-location
!python3 -m pip install mlxtend \
--user --quiet --no-warn-script-location
path='/home/sc_work/.sage/local/lib/python3.8/site-packages'
import sys; sys.path.append(path)
import numpy,warnings; warnings.simplefilter('ignore')
from sklearn import datasets,model_selection
from sklearn import svm,linear_model 
from mlxtend.regressor import StackingRegressor
from sklearn.neighbors import \
KNeighborsRegressor,RadiusNeighborsRegressor
from sklearn.ensemble import \
GradientBoostingRegressor,RandomForestRegressor
boston=datasets.load_boston()
X,y=boston.data,boston.target
regs=[GradientBoostingRegressor(),
      KNeighborsRegressor(),svm.SVR(kernel='linear')]
sreg1=StackingRegressor(regressors=regs,\
      meta_regressor=RandomForestRegressor(random_state=1))
sreg2=StackingRegressor(regressors=regs,\
      meta_regressor=linear_model.Ridge(random_state=1))
sreg3=StackingRegressor(regressors=regs,\
      meta_regressor=linear_model.\
      PassiveAggressiveRegressor(max_iter=1000,tol=.001))
labels=['GradientBoosting','KNeighbors','SVM',
        'StackingRegressor - RandomForest',
        'StackingRegressor - Ridge',
        'StackingRegressor - PassiveAggressive']
for reg,label in zip(regs+[sreg1,sreg2,sreg3],labels):    
    print(label); reg.fit(X,y)
    print('Mean Squared Error: %.4f'\
          %numpy.mean((reg.predict(X)-y)**2))
    print('Variance Score: %.4f'%reg.score(X,y))
</script></div>
    <h1>Drawing by parametric plots</h1>
R &#38; SageMathCell<br/>
<div class='sage_r'><script type='text/x-sage'>
%%r
svg(filename='Rplots.svg',width=7,height=7,onefile=TRUE,
    pointsize=14,family='courier',bg='slategray',
    antialias=c('default','none','gray','subpixel'))
t<-seq(0,2*pi,len=360); d<-.04; c0<-'white'
f<-exp(cos(t)^2+sin(t))-3*cos(4*t)+sin(t/12)
x<-f*cos(t); y<-f*sin(t) 
for(i in 1:25){
    plot(d*i*x,d*i*y,type='l',col=rgb(d*i,0,1-d*i),
         xlim=c(-6,6),ylim=c(-4,6), xlab='x',ylab='y',
         cex=.8,fg=c0,col.axis=c0,col.lab=c0)
    par(margin=c(0,0,0,0)); par(new=TRUE)}
grid(col=c0); dev.off()
</script></div>
     <h1>Do you want to publish your Wolfram notebook?</h1>
HTML &#38; SageMathCell<br/>
<div class='sage_html'><script type='text/x-sage'>
%%html
<iframe width='99%' height='500' 
src='https://www.wolframcloud.com/obj/safuolga/Published/wolfram24.nb'/>
</script></div>
  </body>
</html>