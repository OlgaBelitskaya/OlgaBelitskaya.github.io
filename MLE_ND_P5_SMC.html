<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=0.9*device-width">
    <title>MLE_ND_P5_SMC</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function () {
    sagecell.makeSagecell({inputLocation:'div.linked',linked:true,evalButtonText:'Run Linked Cells'});  
    sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run'});
    });
    </script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron|Roboto');
  body {background-color:#b8e2fc;}; a, p {color:royalblue; font-family:'Roboto';} 
  h1 {color:#191970; font-family:'Orbitron'; text-shadow:4px 4px 4px #ccc;} 
  h2, h3 {color:slategray; font-family:'Orbitron'; text-shadow:4px 4px 4px #ccc;}
  h4 {color:#191970; font-family:'Roboto';}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:48em;}
  .sagecell table.table_form tr.row-a {background-color:lightgray;} 
  .sagecell table.table_form tr.row-b {background-color:#b8e2fc;}
  .sagecell table.table_form td {padding:5px 15px; color:royalblue; font-family:'Roboto';}
  .sagecell_sessionOutput, .sagecell_sessionOutput pre {color:royalblue; font-family:'Roboto';}
  </style>  
  <body>
    <h1>Machine Learning Engineer Nanodegree</h1>
    <h2>Deep Learning</h2>
    <h1>&#x1F4D1; &nbsp;P5: Build a Digit Recognition Program</h1>
    <h2>Step 0: Load and Create Datasets</h2>      
    <h3>Resources</h3>
<a href="https://scikit-learn.org/stable/index.html">&#x1F578;scikit-learn. Machine Learning in Python&nbsp;</a>
<a href="http://scipy-lectures.org/">&#x1F578;Scipy Lecture Notes&nbsp;</a><br/>
    <h3>Code Library</h3> 
<div class="linked"><script type="text/x-sage">
import numpy,pandas,scipy,pylab,urllib; pylab.style.use('seaborn-whitegrid')
import warnings; from sklearn.exceptions import DataConversionWarning
for el in [FutureWarning,UserWarning,DataConversionWarning]: warnings.filterwarnings("ignore",category=el)
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn import datasets,metrics,preprocessing
</script></div>
    <p></p>
<div class="linked"><script type="text/x-sage">
def ohe(x): return preprocessing.OneHotEncoder(categories='auto').fit(x.reshape(-1,1))\
            .transform(x.reshape(-1,1)).toarray().astype('int16')
def sas(X,y): return train_test_split(X,y,test_size=0.2,random_state=1)
</script></div>
    <p></p> 
    <h3>Experimental Datasets</h3>
<h4>Dataset #1. Scikit-learn. Digits.</h4>
<div class="linked"><script type="text/x-sage">
digits=datasets.load_digits(n_class=10)
X_train1,y_train1,X_test1,y_test1=sas(digits.data,digits.target)
cy_train1=ohe(y_train1); cy_test1=ohe(y_test1)
X_train1.shape,y_train1.shape,X_test1.shape,y_test1.shape
</script></div>
    <p></p>
<div class="linked"><script type="text/x-sage">
n=5; img=numpy.zeros((10*n,10*n))
for i in range(n): 
    for j in range(n): img[(10*i+1):(10*i+9),(10*j+1):(10*j+9)]=X1[i*n+j].reshape((8,8))
pylab.figure(figsize=(5,5)); pylab.imshow(img,cmap=pylab.cm.bone)
pylab.title('Examples of 64-dimensional digits')
pylab.xticks([]); pylab.yticks([]); pylab.show()
</script></div>
    <p></p> 
<h4>Dataset #2. MNIST</h4>
<div class="linked"><script type="text/x-sage">
path='https://s3.amazonaws.com/img-datasets/'; f='mnist.npz'
input_file=urllib.urlopen(path+f); output_file=open(f,'wb'); output_file.write(input_file.read()) 
input_file.close(); output_file.close(); mnist=numpy.load(f) 
[X_train2,cy_train2,X_test2,cy_test2]=[mnist[el]for el in ['x_train','y_train','x_test','y_test']]
y_train2=numpy.array([numpy.where(r==1)[0][0] for r in cy_train2]).reshape(len(cy_train2),1)
y_test2=numpy.array([numpy.where(r==1)[0][0] for r in cy_test2]).reshape(len(cy_test2),1)
X_train2.shape,y_train2.shape,X_test2.shape,y_test2.shape
</script></div>
    <p></p>
<div class="linked"><script type="text/x-sage">
fig,ax=pylab.subplots(figsize=(5,6),nrows=5,ncols=5,sharex=True,sharey=True)
ax=ax.flatten(); [ax[i].imshow(X_train2[i],cmap=pylab.cm.Blues) for i in range(25)]
ax[0].set_xticks([]); ax[0].set_yticks([]); pylab.tight_layout(); pylab.gcf() 
ax[2].set_title('Examples of the 784-dimensional digits',fontsize=12); pylab.show()
</script></div>
    <p></p>
<div class="linked"><script type="text/x-sage">

</script></div>
    <p></p>
    <h3>Additional Code Cell</h3>
<div class="linked"><script type="text/x-sage">

</script></div>
    <p></p> 
  </body>
</html>