<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>SageMathCell</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
    });
    </script>
  </head>
  <style>
  h1 {color:#3636ff; text-shadow:5px 5px 5px #aaa;}
  h2 {color:darkblue; text-shadow:5px 5px 5px #aaa;}
  p, th {font-size:110%; text-shadow:5px 5px 5px #aaa;}
  </style>  
  <body>
  <h1>&#x1F4D1; &nbsp; Лабораторная работа №1</h1>
  <h1>«Сортировка. Символы. Множества»</h1>
  <h2>Вариант 22</h2>
      
  <h2>Задание</h2>
<p>Упорядочить символы строки, расположив символы в указанном в нижеследующей таблице порядке (по вариантам) двумя способами:</p> 
<p>- с созданием своей таблицы символов и </p>
<p>- без ее создания (со сложным условием сравнения и множествами). </p>
<p>Провести анализ аномалий: строка не пустая и других символов (кроме указанных) нет. </p>
<p>При выводе результата в начало строки и в конец добавить символ " (двойная кавычка) для обозначения начала и конца строки, </p>
<p>что особенно актуально для строк из пробелов и других непечатных символов (s:= +«нужный символ»+s+«нужный символ или строка»). </p>
<p>- Указание 1. Для проверки и сортировки использовать процедуры, расположенные в отдельном модуле. </p>
<p>- Указание 2. Для проверки принадлежности символа к одной из трёх групп использовать множества. </p>
<p>- Указание 3. Изменить (упорядочить) заданную строку по указанному в каждом варианте правилу «на месте» без создания дополнительной строки (или массива, файла и т.д.).</p>
  <h2>1. Условие задачи</h2>            
<p>Упорядочить строку, расположив символы в указанном в таблице порядке, убедившись, что строка не пустая и других символов (кроме указанных) нет.</p>
<table border="1" style="width:100%;">
  <tr>
    <th>Сначала идут символы</th>
    <th>Затем символы</th> 
    <th>А в конце – символы</th>
  </tr>
  <tr>
    <td>Кириллицы строчные в исходно заданном порядке, включая ё</td>
    <td>Кириллицы ЗАГЛАВНЫЕ в алфавитном порядке (А..ЕЁ..Я)</td> 
    <td>Цифры в исходно заданном порядке</td>
  </tr>
</table> 
  <h2>2. Уточненное условие задачи</h2>
<p>Задана строка S. Проверить, что строка S не пустая и состоит только из цифр, заглавных и строчных букв кириллицы:</p> 
<p>- если строка пустая - вывести сообщение «Пустая строка»,</p>
<p>- если присутствуют иные символы - вывести сообщение «Некорректные символы»,</p> 
<p>- в противном случае, расположить символы строки в указанном в таблице порядке и вывести результат на экран.</p>
<p>Таблица допустимых символов: абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ0123456789</p>
<p>Для ввода и упорядочивания строки нажмите кнопку «Activate».</p>
<p>Примеры строк для тестирования.</p>
<table border="1" style="width:50%;">
  <tr><th>Номер</th><th>Строка</th></tr>
  <tr><td>   1</td><td>   u''</td></tr>
  <tr><td>   2</td><td>   u'iJщюкQ4'</td></tr>
  <tr><td>   3</td><td>   u'01234'</td></tr>
  <tr><td>   4</td><td>   u'Ау'</td></tr>
  <tr><td>   5</td><td>   u'ЁЖИКВТУМАНЕ'</td></tr>
  <tr><td>   6</td><td>   u'StartEnd'</td></tr>
  <tr><td>   7</td><td>   u'adressADRESS'</td></tr>
  <tr><td>   8</td><td>   u'358морозИсолнцеДЕНЬчудестный123'</td></tr>
  <tr><td>   9</td><td>   u'123FirstSecondThirdОЮИ'</td></tr>
</table>      
<div id="mycell"><script type="text/x-sage">
symbol_table = u'абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ0123456789'
test_strings = [u'',u'iJщюкQ4',u'01234',u'Ау',u'ЁЖИКВТУМАНЕ',u'StartEnd',u'adressADRESS',
                u'358морозИсолнцеДЕНЬчудестный123',u'123FirstSecondThirdОЮИ']
c = 0
for s in test_strings:
    c += 1
    s1 = ''.join([s[i] for i in range(len(s)) if s[i] in symbol_table[:33]])
    s2 = ''.join(sorted([s[i] for i in range(len(s)) if s[i] in symbol_table[33:39]]))
    s3 = ''.join([s[i] for i in range(len(s)) if s[i] == symbol_table[39]])
    s4 = ''.join(sorted([s[i] for i in range(len(s)) if s[i] in symbol_table[40:66]]))
    s5 = ''.join([s[i] for i in range(len(s)) if s[i] in symbol_table[66:]])
    if len(s)==0: print c,' ',s,'->','"Пустая строка"'
    elif len(s1+s2+s3+s4+s5)!=len(s): print c,' ',s,'->','"Некорректные символы"'
    else: print c,' ',s,'->','"'+s1+s2+s3+s4+s5+'"'
</script></div>
  <h2>3. Пример</h2>
<p>Для проверки результата нажмите кнопку «Evaluate».</p>
<p>Ячейки SageMath для экспериментов</p>     
<div class="compute"><script type="text/x-sage">
# сортировка с помощью множеств символов
import re
scyrillic_letters,bcyrillic_letters,figures = ur'[а-я,ё]',ur'[А-Я,Ё]',ur'[0-9]'
bcyrillic_letters1,bcyrillic_letters2 = ur'[А-Е]',ur'[Ж-Я]'
test_strings = [u'',u'iJщюкQ4',u'01234',u'Ау',u'ЁЖИКВТУМАНЕ',u'StartEnd',u'adressADRESS',
                u'358морозИсолнцеДЕНЬчудестный123',u'123FirstSecondThirdОЮИ']
for s in test_strings:
    s1 = ''.join(re.findall(scyrillic_letters,s,re.U))+\
         ''.join(sorted(re.findall(bcyrillic_letters1,s,re.U)))+\
         ''.join(re.findall(ur'[Ё]',s,re.U))+\
         ''.join(sorted(re.findall(bcyrillic_letters2,s,re.U)))+\
          ''.join(re.findall(figures,s,re.U))
    if len(s)==0: print s,'->','"Пустая строка"'
    elif len(s1)!=len(s): print s,'->','"Некорректные символы"'
    else: print s,'->','"'+s1+'"'
</script></div>
<p></p>
<div class="compute"><script type="text/x-sage">
# сортировка с помощью таблицы символов
symbol_table = u'абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ0123456789'
test_strings = [u'',u'iJщюкQ4',u'01234',u'Ау',u'ЁЖИКВТУМАНЕ',u'StartEnd',u'adressADRESS',
                u'358морозИсолнцеДЕНЬчудестный123',u'123FirstSecondThirdОЮИ']
for s in test_strings:
    s1 = ''.join([s[i] for i in range(len(s)) if s[i] in symbol_table[:33]])
    s2 = ''.join(sorted([s[i] for i in range(len(s)) if s[i] in symbol_table[33:39]]))
    s3 = ''.join([s[i] for i in range(len(s)) if s[i] == symbol_table[39]])
    s4 = ''.join(sorted([s[i] for i in range(len(s)) if s[i] in symbol_table[40:66]]))
    s5 = ''.join([s[i] for i in range(len(s)) if s[i] in symbol_table[66:]])
    if len(s)==0: print s,'->','"Пустая строка"'
    elif len(s1+s2+s3+s4+s5)!=len(s): print s,'->','"Некорректные символы"'
    else: print s,'->','"'+s1+s2+s3+s4+s5+'"'
</script></div>      
<p>Дополнительная ячейка для экспериментов</p>
<div class="compute"><script type="text/x-sage">
import re
s = u'358морозИсолнцеДЕНЬчудестный123'
sc = ''.join(re.findall(ur'[а-я,ё]',s,re.U))
print s,'\n',len(s),'\n',sc,'\n',len(sc)
</script></div>
<p>Ячейки для экспериментов на других языках: R, HTML, JavaScript</p>
<div class="compute"><script type="text/x-sage">
%%r
string <- '358морозИсолнцеДЕНЬчудестный123'; nchar(string)
</script></div>
<p></p>
<div class="compute"><script type="text/x-sage">
%%html
<p id="js_output"></p>
</script></div>
<div class="compute"><script type="text/x-sage">
%%javascript
var string = '358морозИсолнцеДЕНЬчудестный123';
document.getElementById("js_output").innerHTML = string.length;
</script></div>
<h2>4. Таблица данных</h2>
<table border="1" style="width:100%;">
  <tr><th>Класс</th><th>Имя</th><th>Описание (смысл)</th><th>Тип</th><th>Структура</th><th>Формат</th></tr>
  <tr><td>исходные</td><td>S</td><td>исходная строка</td><td>символьный</td><td>строка</td><td>-</td></tr>
  <tr><td>выходные</td><td>S1</td><td>отсортированная строка без своей таблицы символов</td><td>символьный</td><td>строка</td><td>-</td></tr>
  <tr><td>выходные</td><td>S2</td><td>отсортированная строка со своей таблицей символов</td><td>символьный</td><td>строка</td><td>-</td></tr>
  <tr><td>промежуточные</td><td>N</td><td>номер аномальной ситуации (1 или 2), или 0, если нет аномалий</td><td>цел</td><td>простая переменная</td><td>-</td></tr>
</table> 
<h2>5,6. Форма ввода/вывода</h2>
<table border="1" style="width:50%;">
  <tr><th>Форма ввода</th><th>Форма вывода </th><tr>      
  <tr><td>Введите строку &#60;S&#62;</td><td>Строка до сортировки &#60;S1&#62;</td></tr>
  <tr><td> - </td><td>Отсортированная 1-м способом строка &#60;S1&#62;</td></tr>  
  <tr><td> - </td><td>Строка до сортировки &#60;S2&#62;</td></tr>
  <tr><td> - </td><td>Отсортированная 2-м способом строка &#60;S2&#62;</td></tr>
</table>
<h2>7. Аномалии</h2>
<table border="1" style="width:100%;">
  <tr><th>№</th><th>Описание</th><th>Условие</th><th>Ожидаемая реакция</th></tr>
  <tr><td>1</td><td>Пустая строка S</td><td>S = ''</td><td>«Пустая строка»</td></tr>
  <tr><td>2</td><td>Есть запрещенные символы</td><td>Есть символ S[i], для которого НЕ выполняется условие</td><td>«Некорректные символы»</td></tr>
  <tr><td> - </td><td> - </td><td>(S[i] &#8712; ['а'..'я','ё']) or</td><td> - </td></tr>
  <tr><td> - </td><td> - </td><td>(S[i] &#8712; ['А'..'ЕЁ'..'Я']) or</td><td> - </td></tr>
  <tr><td> - </td><td> - </td><td>(S[i] &#8712; ['0'..'9'])</td><td> - </td></tr>
</table>       
<h2>8. Функциональные тесты</h2>
<table border="1" style="width:100%;">
  <tr><th>№</th><th>Исходные данные</th><th>Ожидаемый результат</th><th>Смысл теста</th></tr>
  <tr><td>1</td><td>S = ''</td><td>«Пустая строка»</td><td>Аномалия 1 «Пустая строка»</td></tr>
  <tr><td>2</td><td>S = 'iJщюкQ4'</td><td>«Некорректные символы»</td><td>Аномалия 2 Есть запрещенные символы</td></tr>
  <tr><td>3</td><td>S = '01234'</td><td>S = '01234'</td><td>Есть только символы третьей части, они выводятся в исходном порядке</td></tr>
  <tr><td>4</td><td>S = 'Ау'</td><td>S = 'уА'</td><td>Есть только символы первой и второй части, из первой части выводятся раньше, чем из второй</td></tr>
  <tr><td>5</td><td>S = 'ЁЖИКВТУМАНЕ'</td><td>S = 'АВЕЁЖИКМНТУ'</td><td>Есть только символы второй части, выводятся в алфавитном порядке</td></tr>
  <tr><td>6</td><td>S = 'StartEnd'</td><td>«Некорректные символы»</td><td>Аномалия 2 Есть запрещенные символы</td></tr>
  <tr><td>7</td><td>S = 'adressADRESS'</td><td>«Некорректные символы»</td><td>Аномалия 2 Есть запрещенные символы</td></tr>
  <tr><td>8</td><td>S = '358морозИсолнцеДЕНЬчудестный123'</td><td>S = 'морозсолнцечудестныйДЕИНЬ358123У'</td><td>Есть символы всех видов, выводятся в заданном порядке</td></tr>
  <tr><td>9</td><td>S = '123FirstSecondThirdОЮИ'</td><td>«Некорректные символы»</td><td>Аномалия 2 Есть запрещенные символы</td></tr>
</table>
<h2>9. Метод</h2>
<p>1. Введем строку (ввод с клавиатуры в режиме диалога), создадим две копии исходной строки – S1 и S2.</p>
<p>Для каждого из двух методов выполним пункты 2-4:</p>
<p>2. Проверим аномалии. Для проверки аномалий напишем функции Prov1 и Prov2 (без и со своей таблицей символов), возвращающие номер аномальной ситуации N.</p>
<p>3. В случае корректной строки – отсортируем ее по указанному правилу с помощью процедур Sort1 и Sort2. Сортировать будем «пузырьком», указав ВСЕ случаи, когда два СОСЕДНИХ элемента стоят в НЕправильном порядке.</p>
<p>4. Выведем сообщение или отсортированную строку на экран.</p>
<h2>10. Основной алгоритм</h2>
<div style="width:450px; height:650px; overflow:auto;"><img src="lab_images/Lab1_2_22_1.png" width="440" height="640"/></div>
<h2>11. Программный код Pascal</h2>
<table><tr><td style="font-size:130%;font-weight:bold;text-align:left;"><pre><code class='pascal'> 
Program Lab1;
{$AppType CONSOLE}
 
Uses Windows, UnLAB1;
 
Var 
    S,S1,S2: ANSIString;
    N: Byte;
        
Begin
    // сменим кодовые страницы  для консольного ввода и вывода
    setConsoleCP(1251); // для ввода 
    setConsoleOutputCP(1251); // для вывода 
 
    writeln('Введите строку (смените шрифт на Lucida Console)');
    readln(S); // ввод 
 
    S1:=copy(S,1,length(S)); S2:=copy(S,1,length(S)); // создание копий дин.строки 
            
    // без своей таблицы символов (со сложным условием обмена)
    writeln(#13#10, 'Строка до сортировки'#13#10,S1);
    N:= Prov1(s1); // проверка
    case N of
        1: writeln('Пустая строка');
        2: writeln('Некорректные символы');
        else
        begin // сортировка
           Sort1(s1);
           writeln('Отсортированная строка 1'#13#10,S1);  // вывод строки S1
        end; {else}
    end; {case}
  
    // со своей таблицей символов
    writeln(#13#10'Строка до сортировки'#13#10,S2);
    N:= Prov2(s2); // проверка
    case N of
        1: writeln('Пустая строка');
        2: writeln('Некорректные символы');
        else
        begin // сортировка
           Sort2(s2);
           writeln('Отсортированная строка 2'#13#10, S2);  // вывод строки S2
        end; {else}
    end; {case}
 
    writeln(#13#10'Press ENTER to exit');
    readln
End.
</code></pre></td></tr></table> 
<h3>Исходный код модуля<h3>      
 <table><tr><td style="font-weight:bold;text-align:left;"><pre><code class='pascal'> 
Unit UnLAB1;      // имя модуля – меняется при сохранении File → Save As…
Interface       // раздел описания межмодульного интерфейса
 
Uses     
    SysUtils;
    
Const
    SymbTable = 'абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ0123456789';

Const
    BukvKirS: set of char = ['а'..'я','ё'];
    BukvKirB: set of char = ['А'..'Я','Ё'];    
    Cifr : set of '0'..'9' = ['0'..'9'];
    BukvKirB1: set of char = ['А'..'Е']; 
    BukvKirB2: set of char = ['Ж'..'Я'];    

Function Prov1(const s: ANSIString): Byte; // проверка без SymbTable
Function Prov2(const s: ANSIString): Byte; // проверка с SymbTable
Procedure Sort1(var s: ANSIString);  // сортировка без SymbTable
Procedure Sort2(var s: ANSIString);  // сортировка с SymbTable
 
Implementation  // раздел реализации и описания закрытых процедур

Function Prov1; // проверка без SymbTable
Var
    N: byte; // номер аномалии
    i,Len: word; // текущий символ и длина строки
Begin
    N:=0; Len:=Length(S);
    if Len=0 then N:=1
    else
    begin
        i:=1;
        while (i<=Len) and (N=0) do
        begin
            if not ((S[i] in Cifr) or (S[i] in BukvKirS) or (S[i] in BukvKirB)) then N:=2;
            Inc(i);
        end;
    end;
    Prov1:=N; 
End;

Function Prov2; // проверка с SymbTable
Var
    N: byte; // номер аномалии
    i,Len: word; // текущий символ и длина строки
Begin
    N:=0; Len:=Length(S);
    if Len=0 then N:=1
    else
    begin
        i:=1;
        while (i<=Len) and (N=0) do
        begin
            if not (Pos(S[i],SymbTable)>0) then N:=2;
            Inc(i);
        end;
    end;
    Prov2:=N; 
End;

Procedure Sort1;  // сортировка без SymbTable
Var 
    i,z,Len: word; // номер текущего символа, номер итерации (шага), длина строки
    flag: boolean; // упорядочено? (нет обменов?)
    ch: char; // для обмена
Begin
    z:=1; Len:=length(s);
    repeat // пузырёк
        flag:=true;
        for i:=1 to Len-z do
            if ( (s[i] in Cifr) and ((s[i+1] in BukvKirS) or (s[i+1] in BukvKirB)) ) or // цифры «легче» всех
               ( (s[i] in BukvKirB) and (s[i+1] in BukvKirS) ) or 
                // кириллица заглавные «легче» строчных – всплывает
               ( (s[i] in BukvKirB2) and (s[i+1] in BukvKirB1) ) or 
                // кириллица заглавные 2 «легче» кириллицы заглавных 1 – всплывает
               ( (s[i]='Ё') and (s[i+1] in BukvKirB1) ) or 
                // кириллица Ё «легче» кириллицы заглавных 1 – всплывает
               ( (s[i] in BukvKirB1) and (s[i+1] in BukvKirB1) and (s[i]>s[i+1]) ) or 
                // кириллица заглавные 1 – по алфавиту
               ( (s[i] in BukvKirB2) and (s[i+1] in BukvKirB2) and (s[i]>s[i+1]) ) or 
                // кириллица заглавные 2 – по алфавиту
            then
            begin // обмен
                ch:=s[i]; s[i]:=s[i+1]; s[i+1]:=ch; flag:= false;
            end ;
        inc(z);
    until flag or (z=Len);
End; 

Procedure Sort2;  // сортировка с SymbTable
Var 
    i,z,Len,P1,P2: word; // номер текущего символа, номер итерации (шага), длина строки, позиции текущих символов
    flag: boolean; // упорядочено? (нет обменов?)
    ch: char; // для обмена
Begin
    z:=1;  Len:=length(s);
    repeat // пузырёк
        flag:=true;
        for i:=1 to Len-z do
            P1:=Pos(s[i],SymbTable); P2:=Pos(s[i+1],SymbTable);
            // неправильный порядок по своей «таблице»
            if (P1 &#62; 66 and P2 &#60; 67) or (P1 &#62; 33 and P2 &#60; 34)
               or (P1 &#62; P2 and P1 &#62; 33 and P2 &#62; 33 and P1 &#60; 67 and P2 &#60; 67)
            then
            begin // обмен
                ch:=s[i]; s[i]:=s[i+1]; s[i+1]:=ch; flag:=false;
            end;
        inc(z);
    until flag or (z=Len);
End; 
 
End.
</code></pre></td></tr></table>
     
<h2>12. Алгоритмы процедур</h2>
<h3>A0.1. Проверка аномалий</h3>
<div style="width:460px; height:460px; overflow:auto;"><img src="lab_images/Lab1_2_22_2.png" width="450" height="450"/></div>   <h3>А0.2. Сортировка «пузырьком»</h3>
<div style="width:660px; height:660px; overflow:auto;"><img src="lab_images/Lab1_2_22_3.png" width="650" height="650"/></div>

<p>(**) &#8801; (S1[i] &#8712; ['0'..'9']) &#8743; ((S1[i+1] &#8712; ['а'..'я','ё']) &#8744; (S1[i+1] &#8712; ['А'..'Я','Ё'])) &#8744;<\p> 
<p>(S1[i] &#8712; ['А'..'Я', 'Ё']) &#8743; (S1[i+1] &#8712; ['а'..'я','ё']) &#8744; </p> 
<p>(S1[i] &#8712; ['Ж'..'Я']) &#8743; (S1[i+1] &#8712; ['А'..'Е']) &#8744; </p>
<p>(S1[i] = 'Ё') &#8743; (S1[i+1] &#8712; ['А'..'Е']) &#8744; </p>
<p>(S1[i] &#8712; ['А'..'Е']) &#8743; (S1[i+1] &#8712; ['А'..'Е']) &#8743; (S1[i]>S1[i+1])&#8744; </p>
<p>(S1[i] &#8712; ['Ж'..'Я']) &#8743; (S1[i+1] &#8712; ['Ж'..'Я']) &#8743; (S1[i]>S1[i+1])</p>
    
    </body>
</html>