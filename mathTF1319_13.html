<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Maths_TF1319_13</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function(){
            sagecell.makeSagecell({inputLocation:'div.link1',linked:true,evalButtonText:'Run Linked Sage Cells'});
            sagecell.makeSagecell({inputLocation:'div.link2',linked:true,evalButtonText:'Run Linked Py Cells'});
            sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run Detached Cells'});
        });
    </script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron');
  h1, h2 {color:#3636ff; font-family:'Orbitron'; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:38em;}
  </style>  
  <body>
  <h1>&#x1F4D1; &nbsp;Maths. TF1319. Standard Calculation 13</h1>
Conduct a complete study of functions and build their graphs.   
  <h2>Task 1</h2>
1) Найдем область определения функции и точки разрыва.<br/>
$\displaystyle{y = \frac{4}{x^2+2 x-3} = \frac{4}{(x-1) \ (x+3)}}$<br/>
$\displaystyle{D(y)= (-\infty; -3) \cup (-3; 1) \cup (1; +\infty)}$<br/>
$\displaystyle{x = -3; x = 1}$ - точки разрыва второго рода.<br/>
2) Вычислим односторонние пределы функции<br/>
- в граничных точках области определения, <br/>
- в точках разрыва. <br/>
Найдем вертикальные асимптоты.<br/>
$\displaystyle{\lim_{x \to +\infty} \frac{4}{x^2+2 x-3} = \lim_{x \to +\infty} \frac{4}{x^2} = 0}$<br/>
$\displaystyle{\lim_{x \to -\infty} \frac{4}{x^2+2 x-3} = \lim_{x \to -\infty} \frac{4}{x^2} = 0}$<br/>
$\displaystyle{\lim_{x \to -3+0} \frac{4}{x^2+2 x-3} = \frac{4}{(-3+0-1) \ (-3+0+3)} = \frac{4}{+ 0 \ (-4+0)} = -\infty }$<br/>
$\displaystyle{\lim_{x \to -3-0} \frac{4}{x^2+2 x-3} = \frac{4}{(-3-0-1) \ (-3-0+3)} = \frac{4}{- 0 \ (-4-0)} = +\infty}$<br/>
$\displaystyle{\lim_{x \to 1+0} \frac{4}{x^2+2 x-3} = \frac{4}{(1+0-1) \ (1+0+3)} = \frac{4}{+0 \ (4+0)} = +\infty}$<br/>
$\displaystyle{\lim_{x \to 1-0} \frac{4}{x^2+2 x-3} = \frac{4}{(1-0-1) \ (1-0+3)} = \frac{4}{-0 \ (4-0)} = -\infty}$<br/>
Прямые $x = -3, \ x = 1$ являются вертикальными асимптотами.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 (#7.21)
var('x'); y21=4/(x^2+2*x-3)
pretty_print(html('$y=%s=%s$'%(latex(y21),latex(y21.factor()))))
for x0 in [oo,-3,1]:
    print('x='+str(x0)+ ' => right & left limits: %s'%[limit(y21,x=x0,dir='+'),limit(y21,x=x0,dir='-')])
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1 (#7.21)
import sympy as sp; import numpy as np; import pylab as pl
x=sp.symbols('x'); y21=4/(x**2+2*x-3); sp.pprint('y=%s=%s'%(y21,sp.factor(y21)))
for x0 in ['oo',-3,1]:
    print('x='+str(x0)+ ' => right & left limits: %s'%\
          [sp.limit(y21,x,x0,dir='+'),sp.limit(y21,x,x0,dir='-')])
</script></div><br/>
3) Проверим, является ли функция четной, нечетной, периодической.<br/>
$\displaystyle{y(-x) = \frac{4}{(-x)^2 + 2 (-x) - 3} = \frac{4}{x^2 - 2x - 3} \implies y(-x) \neq y(x) \land y(-x) \neq -y(x)}$<br/>
Функция не является четной или нечетной.<br/>
Обозначим $ t \neq 0$ предполагаемый период функции.<br/>
$\displaystyle{y(x + t) = y(x) \iff \frac{4}{(x + t)^2 + 2 (x + t) - 3} = \frac{4}{x^2 + 2x - 3} \iff}$ <br/>
$\displaystyle{\iff  (x + t)^2 + 2 (x + t) = x^2 + 2x \iff 2 x t + t^2 + 2 t= 0 \iff}$<br/>
$\displaystyle{\iff t \ (t + 2 x + 2) = 0 \iff t = 0 \lor t = -2x - 2}$<br/>
$\displaystyle{t \neq const \land t = t(x)}$<br/>
Функция не является периодической.<br/>
4) Найдем точки пересечения графика функции с осями координат.<br/>
$\displaystyle{x = 0 \implies y = \frac{4}{0 ^2+ 2 * 0 - 3} \approx -1.33 }$<br/>
$\displaystyle{\forall x \in \mathbb{R}: y(x) \neq 0}$<br/>
График функции пересекает ось $Oy$ в точке $(0; -1\frac{1}{3})$ и не пересекает ось $Ox$.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 
[y21(x=0),solve(y21==0,x)]
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
[y21(x=0),sp.solve(y21,0)]
</script></div><br/>
5) Найдем наклонные асимпоты графика функции.<br/>
Вычислим коэффициенты для прямой $y = kx + b$, являющейся наклонной асимптотой.<br/>
$\displaystyle{k=\lim_{x \to +\infty} \frac{\frac{4}{x^2+2 x-3}}{x} = \lim_{x \to +\infty} \frac{4}{x^3+2x^2-3 x} = 0}$<br/>
$\displaystyle{k=\lim_{x \to -\infty} \frac{\frac{4}{x^2+2 x-3}}{x} = \lim_{x \to -\infty} \frac{4}{x^3+2x^2-3 x} = 0}$<br/>
$\displaystyle{b=\lim_{x \to +\infty} \frac{4}{x^2+2 x-3}-kx = \lim_{x \to +\infty} \frac{4}{x^2+2 x-3}-0=0}$<br/>
$\displaystyle{b=\lim_{x \to -\infty} \frac{4}{x^2+2 x-3}-kx = \lim_{x \to -\infty} \frac{4}{x^2+2 x-3}-0=0}$<br/>
$y = 0$ - уравнение наклонной асимптоты.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 
x0='oo'; s='x='+str(x0)+' => '
print(s+'k='+str([limit(y21/x,x=x0,dir='+'),limit(y21/x,x=x0,dir='-')]))
print(s+'b='+str([limit(y21-limit(y21/x,x=x0)*x,x=x0,dir='+'),
                  limit(y21-limit(y21/x,x=x0)*x,x=x0,dir='-')]))
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
x0='oo'; s='x='+str(x0)+' => '
print(s+'k='+str([sp.limit(y21/x,x,x0,'+'),sp.limit(y21/x,x,x0,'-')]))
print(s+'b='+str([sp.limit(y21-sp.limit(y21/x,x,x0)*x,x,x0,'+'),
                  sp.limit(y21-sp.limit(y21/x,x,x0)*x,x,x0,'-')]))
</script></div><br/>
6) Вычислим первую производную. Найдем точки локального экстремума и промежутки монотонности.<br/>
$\displaystyle{y ' =\bigg(\frac{4}{x^2+2 x-3}\bigg) ' =\frac{(4)' \ (x^2+2 x-3)-4 \ (x^2+2 x-3)'}{(x^2+2 x-3)^2}=}$<br/>
$\displaystyle{= \frac{0 \ (x^2+2 x-3)-4 \ (2 x+2 x)}{(x^2+2 x-3)^2} = \frac{-8 \ ( +1)}{(x+3)^2 (x-1)^2}}$<br/>
Функция может иметь локальный экстремум в критических точках, если:<br/>
- функция определена и непрерывна в этих точках,<br/>
- значение производной в них равно нулю или не существует.<br/>
В данном случае производная функции определена на всей $ D(y)= (-\infty; -3) \cup (-3; 1) \cup (1; +\infty)$,<br/>
поэтому нужно найти только стационарные точки $x$, для которых $y ' (x) = 0$<br/>
$\displaystyle{\frac{ - 8 \ (x + 1)}{(x + 3)^2 (x - 1)^2} = 0 \iff x = -1}$<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 
print("y'=%s"%str(factor(diff(y21,x))))
print("y'=0 <=> %s"%solve(diff(y21,x),x)[0])
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
print("y'=%s"%str(sp.factor(sp.diff(y21,x))))
print("y'=0 <=> x=%s"%sp.solve(sp.diff(y21,x))[0])
</script></div><br/>
Промежутки монотонности:<br/>
<table style="width:50%" border="2">
  <tr><th>$x$</th><th>$(-\infty; -3)$</th><th>$-3$</th><th>$(-3; -1)$</th>
      <th>$ -1$</th><th>$(-1; 1)$</th><th>$1$</th><th>$(1; +\infty)$</th></tr>
  <tr><td>$y\prime(x)$</td><td>$+$</td><td>$\nexists$</td><td>$+$</td>
      <td>$0$</td><td>$-$</td><td>$\nexists$</td><td>$-$</td></tr>
  <tr><td>$y (x)$</td><td>$\nearrow$</td><td>$\nexists$</td><td>$\nearrow$</td>
      <td>$-1$</td><td>$\searrow$</td><td>$\nexists$</td><td>$\searrow$</td></tr>
</table><br/>
$x = -1$ является точкой локального максимума, $y ( -1 ) = -1$.<br/>
$x = -3$, $x = 1$ не являются точками локального экстремума.<br/>
$(-\infty; -3), \ (-3; -1)$ - функция возрастает.<br/>
$(-1; 1), \ (1; +\infty)$ - функция убывает.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 
print('x=x0 => [y(x0),y(x0)>0,dy(x0),dy(x0)>0]')
for x0 in [-4,-2,0,2]:
    y021=y21(x=x0); dy021=diff(y21,x)(x=x0)
    print('x='+str(x0)+' => '+str([y021,bool(y021>0),dy021,bool(dy021>0)]))
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
print('x=x0 => [y(x0),y(x0)>0,dy(x0),dy(x0)>0]')
for x0 in [-4,-2,0,2]:
    y021=y21(x=x0); dy021=sp.diff(y21,x)(x=x0)
    print('x='+str(x0)+' => '+str([y021,bool(y021>0),dy021,bool(dy021>0)]))
</script></div><br/> 
7) Вычислим вторую производную. Найдем точки перегиба графика функции и промежутки выпуклости.<br/>
$\displaystyle{y '' = \Bigg(\frac{ - 8 \ (x + 1)}{(x^2 + 2 x - 3)^2}\Bigg)' =}$<br/>
$\displaystyle{= -8 * \frac{(x + 1)' \ (x^2 + 2 x - 3)^2 - (x + 1) \ ((x^2 + 2 x - 3)^2)'}{(x^2 + 2 x - 3)^4} = }$<br/>
$\displaystyle{= -8 * \frac{(x^2+2 x-3)^2-2 \ (x+1) \ (x^2+2 x-3) \ (2x+2)}{(x^2+2 x-3)^4} =}$<br/>
$\displaystyle{= -8 * \frac{x^2+2 x-3 -2 \ (2x^2+4 x+2)}{(x^2+2 x-3)^3} =  \frac{8 \ (3 x^2+6 x+7)}{(x^2+2 x-3)^3}}$<br/>
$\displaystyle{y '' = \frac{8 \ (3 x^2 + 6 x + 7)}{(x + 3)^3 (x- 1)^3} }$<br/>
Функция может иметь точки перегиба, если:<br/>
- функция определена и непрерывна в этих точках,<br/>
- значение второй производной в них равно нулю или не существует.<br/>
В данном случае <br/>
- $y\prime\prime (x)$ определена на всей $ D(y)= (-\infty; -3) \cup (-3; 1) \cup (1; +\infty)$,<br/>
- $\nexists x \in \mathbb{R}: y\prime\prime (x) = 0$<br/>
Промежутки выпуклости:<br/>
<table style="width:50%" border="2">
  <tr><th>$x$</th><th>$(-\infty; -3)$</th><th>$-3$</th><th>$(-3; 1)$</th><th>$1$</th><th>$(1; +\infty)$</th></tr>
  <tr><td>$y\prime\prime (x)$</td><td>$+$</td><td>$\nexists$</td><td>$-$</td><td>$\nexists$</td><td>$+$</td></tr>
  <tr><td>$y (x)$</td><td>$\cup$</td><td>$\nexists$</td><td>$\cap$</td><td>$\nexists$</td><td>$\cup$</td></tr>
</table><br/>
Функция не имеет точек перегиба. <br/>
$(-\infty; -3), \ (1; +\infty)$ - график функции является выпуклым вниз.<br/>
$(-3; 1)$ - график функции является выпуклым вверх.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 1 
print("y''=%s"%factor(diff(y21,x,x)))
print('x=x0 => [y(x0),y(x0)>0,d2y(x0),d2y(x0)>0]')
for x0 in [-4,0,4]:
    y021=y21(x=x0); d2y021=diff(y21,x,x)(x=x0)
    print('x='+str(x0)+' => '+str([y021,bool(y021>0),d2y021,bool(d2y021>0)]))
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
print("y''=%s"%sp.factor(sp.diff(y21,x,x)))
print('x=x0 => [y(x0),y(x0)>0,d2y(x0),d2y(x0)>0]')
for x0 in [-4,0,4]:
    y021=y21(x=x0); d2y021=sp.diff(y21,x,x)(x=x0)
    print('x='+str(x0)+' => '+str([y021,bool(y021>0),d2y021,bool(d2y021>0)]))
</script></div><br/> 
8) Построим график функции.
<div class="link1"><script type="text/x-sage"># sage; task 1 
yb=10; cols=['steelblue','darkblue','magenta']
ll=['$%s$'%latex(y21.factor()),'$%s$'%latex(diff(y21,x).factor()),
    '$%s$'%latex(diff(y21,x,x).factor())]
p=plot([y21.factor(),diff(y21,x).factor(),diff(y21,x,x).factor()],(-5,3),
       color=cols,thickness=1.5,legend_label=ll)
p+=sum([point((x0,y21(x0)),color=cols[0],size=25) for x0 in [-4,-1,2]])
p+=line([[-3,-yb],[-3,yb]],color='darkred',linestyle=':',thickness=3,legend_label='$x=-3$')
p+=line([[1,-yb],[1,yb]],color='red',linestyle='-.',thickness=3,legend_label='$x=1$')
p+=line([[-5,0],[3,0]],color='darkorange',linestyle='--',thickness=3,legend_label='$y=0$')
p.set_legend_options(font_size=15); p.show(gridlines=True,figsize=(8,8),ymin=-yb,ymax=yb)
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 1
x=sp.symbols('x'); y21=4/(x**2+2*x-3); p=sp.plot(y21,(x,-5.1,-3.1),show=False)
p.extend(sp.plot(y21,(x,-2.9,0.9),show=False))
p.extend(sp.plot(y21,(x,1.1,3.1),show=False)); p.show()
</script></div><br/> 
<div class="link2"><script type="text/x-sage"># python; task 1
x1=np.linspace(-5.1,-3.1); x2=np.linspace(-2.9,0.9); x3=np.linspace(1.1,3.1)
xa=[x1,x2,x3]; y21=lambda x: 4/(x**2+2*x-3)
dy21=lambda x: -8*(x+1)/(x**2+2*x-3)**2
d2y21=lambda x: 8*(3*x**2+6*x+7)/(x**2+2*x-3)**3
pl.figure(figsize=(9,9)); pl.grid(c='steelblue',ls='--',lw=0.5)
ll1=[r'$y = \frac{4}{x^2 + 2 x - 3}$',r'$y = \frac{-8 \ (x + 1)}{(x + 3)^2 (x - 1)^2} $',
     r'$y = \frac{8 \ (3 x^2 + 6x + 7)}{(x + 3)^3 (x - 1)^3}$']
ll2=[r'$x \in (-5.1; -3.1)$',r'$x \in (-2.9; 0.9)$',r'$x \in (1.1; 2.1)$']
for i in range(3):
    pl.plot(xa[i],y21(xa[i]),c='steelblue',lw=3,label=ll1[0]+','+ll2[i])
    pl.plot(xa[i],dy21(xa[i]),c='darkblue',lw=1,label=ll1[1]+','+ll2[i])
    pl.plot(xa[i],d2y21(xa[i]),c='magenta',lw=1,label=ll1[2]+','+ll2[i])
pl.axvline(-3,c='darkred',ls='--',lw=2,label='$x = - 3$')
pl.axvline(1,c='red',ls='--',lw=2,label='$x = 1$')
pl.axhline(0,c='darkorange',ls='--',lw=2,label='$y = 0$')
pl.scatter([-4,-1,2],[y21(-4),y21(-1),y21(2)],s=50)
pl.xlabel(r'$x$',fontsize=15); pl.ylabel(r'$y$',fontsize=15); pl.ylim(-10,10)
pl.legend(fontsize=10,shadow=True,bbox_to_anchor=(.7,.45)); pl.show()
</script></div><br/> 
  <h2>Task 2</h2>
1) Найдем область определения функции и точки разрыва.<br/>
$\displaystyle{y = 2 \ \ln \frac{x}{x-4}-3}$<br/>
$\displaystyle{D(y)=(-\infty; 0) \cup (4; +\infty)}$<br/>
$\displaystyle{\frac{x}{x-4}>0}$<br/>
$\displaystyle{x = 0; x = 4}$ - точки разрыва второго рода.<br/> 
2) Вычислим односторонние пределы функции<br/>
- в граничных точках области определения, <br/>
- в точках разрыва. <br/>
Найдем вертикальные и горизонтальные асимптоты.<br/>
$\displaystyle{\lim_{x \to +\infty} 2 \ \ln \frac{x}{x-4}-3=-3; \lim_{x \to +\infty}\ln \frac{x}{x-4}=+0}$<br/>
$\displaystyle{\lim_{x \to -\infty} 2 \ \ln \frac{x}{x-4}-3=-3; \lim_{x \to -\infty}\ln \frac{x}{x-4}=-0}$<br/>
$\displaystyle{\lim_{x \to 0+0} 2 \ \ln \frac{x}{x-4}-3=\lim_{x \to 0+0} \ln (1+\frac{4}{x-4})=\ln (1-1-0) \; \nexists }$<br/>
$\displaystyle{\lim_{x \to 0-0} 2 \ \ln \frac{x}{x-4}-3=\lim_{x \to 0-0} \ln (1+\frac{4}{x-4})=\ln (1-1+0)=-\infty }$<br/>
$\displaystyle{\lim_{x \to 4+0} 2 \ \ln \frac{x}{x-4}-3=\lim_{x \to 4+0} \ln (1+\frac{4}{x-4})=\ln (1+4/(4+0-4))=+\infty }$<br/>
$\displaystyle{\lim_{x \to 4-0} 2 \ \ln \frac{x}{x-4}-3=\lim_{x \to 4-0} \ln (1+\frac{4}{x-4})=\ln (1+4/(4-0-4)) \; \nexists}$<br/>
Прямые $x = 0, \ x = 4$ являются вертикальными асимптотами, прямая $y = -3$ - горизонтальной.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 2 (#8.21)
var('x'); y21=2*ln(x/(x-4))-3
pretty_print(html('$$y=%s$$'%latex(y21)))
for x0 in ['oo',0,4]:
    pretty_print('x='+str(x0)+ ' => right & left limits: %s'%[limit(y21,x=x0,dir='+'),limit(y21,x=x0,dir='-')])
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2
import sympy as sp; import numpy as np; import pylab as pl
x=sp.symbols('x'); y21=2*sp.ln(x/(x-4))-3; sp.pprint('y=%s'%y21)
for x0 in ['oo',0,4]:
    print('x='+str(x0)+ ' => right & left limits: %s'%\
          [sp.limit(y21,x,x0,dir='+'),sp.limit(y21,x,x0,dir='-')])
</script></div><br/>
3) Проверим, является ли функция четной, нечетной, периодической.<br/>
$\displaystyle{y(-x)=2 \ln \frac{-x}{-x-4}-3=2 \ln \frac{x}{x+4}-3 \implies y(-x) \neq y(x) \land y(-x) \neq -y(x)}$<br/>
Функция не является четной или нечетной.<br/>
Обозначим $ t \neq 0$ предполагаемый период функции.<br/>
$\displaystyle{y(x+t)=y(x) \iff \frac{x+t}{x+t-4} = \frac{x}{x-4} \iff}$ <br/>
$\displaystyle{\iff (x+t) (x-4)= x (x+t-4) \iff x^2+t x-4 x-4 t=x^2+t x -4x \iff 4 t=0 \iff t=0}$<br/>
$\displaystyle{t \neq const}$<br/>
Функция не является периодической.<br/>
4) Найдем точки пересечения графика функции с осями координат.<br/>
$\displaystyle{x=0 \notin D(y)}$<br/>
$\displaystyle{2 \ln \frac{x}{x-4}-3=0 \implies x=\frac{4 e^{\frac{2}{3}}}{e^{\frac{2}{3}}-1}}$<br/>
График функции не пересекает ось $Oy$ и пересекает ось $Ox$ в точке $x=$.<br/>
<div class="link1"><script type="text/x-sage"># sage; task 2 
pretty_print(html('$y=0 => %s = %s$'%(latex(solve(y21==0,x)[0]),solve(y21==0,x)[0].rhs().n())))
pretty_print(html('$x=0 => y=%s$'%latex(y21(x=0))))
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2
[y21(x=0),sp.solve(y21==0,x)[0], sp.solve(y21==0,x)[0].n()]
</script></div><br/>
5) Найдем наклонные асимпоты графика функции.<br/>
Вычислим коэффициенты для прямой $y=kx+b$, являющейся наклонной асимптотой.<br/>   
<div class="link1"><script type="text/x-sage"># sage; task 2 

</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2

</script></div><br/>
<div class="link1"><script type="text/x-sage"># sage; task 2 

</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2

</script></div><br/>
8) Построим график функции.
<div class="link1"><script type="text/x-sage"># sage; task 2 
set_verbose(-1); var('x'); y21=2*ln(x/(x-4))-3
yb=5; xb=15; cols=['steelblue','darkblue','magenta'];
ll=['$y=%s$'%latex(y21),'$y\prime=%s$'%latex(diff(y21,x).factor()),
    '$y\prime\prime=%s$'%latex(diff(y21,x,x).factor())]
p=plot([y21,diff(y21,x),diff(y21,x,x)],(-xb,xb),color=cols,thickness=1.5,legend_label=ll)
p+=line([[0,-yb],[0,yb]],color='darkred',linestyle='--',thickness=3,legend_label='$x=0$')
p+=line([[4,-yb],[4,yb]],color='red',linestyle='-.',thickness=3,legend_label='$x=4$')
p+=line([[-xb,-3],[xb,-3]],color='darkorange',linestyle=':',thickness=3,legend_label='$y=-3$')
p.set_legend_options(font_size=15); p.show(gridlines=True,figsize=(8,8),ymin=-yb,ymax=yb)
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2
x=sp.symbols('x'); y21=y21=2*sp.ln(x/(x-4))-3 
p=sp.plot(y21,(x,-15,-.1),ylim=(-5,5),show=False,legend='automatic') 
p.extend(sp.plot(y21,(x,.1,3.9),show=False)); p.extend(sp.plot(y21,(x,4.1,15),show=False))
p.extend(sp.plot(sp.diff(y21,x).factor(),(x,-15,15),line_color=(.1,.1,.7),show=False))
p.extend(sp.plot(sp.diff(y21,x,x).factor(),(x,-15,15),line_color=(.9,.1,.9),show=False)) 
p.extend(sp.plot(-3,(x,-15,15),line_color=(.9,.1,.1),show=False)); p.show()
</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 2
x1=np.linspace(-15,-.1); x2=np.linspace(.1,3.9); x3=np.linspace(4.1,15)
xa=[x1,x2,x3]; y21=lambda x: 2*np.log(x/(x-4))-3
dy21=lambda x: -8/(x**2-4*x)
d2y21=lambda x: 16*(x-2)/((x-4)**2*x**2)
pl.figure(figsize=(9,9)); pl.grid(c='steelblue',ls='--',lw=0.5)
ll1=[r'$y = 2\ln \frac{x}{x-4} -3$',r'$y = -\frac{8}{x^2-4 x}} $',
     r'$y = \frac{16 (x-2)}{x^2 (x-4)^2}$']
ll2=[r'$x \in (-15; -0.1)$',r'$x \in (0.1; 3.9)$',r'$x \in (4.1; 15)$']
for i in range(3):
    if i!=1:
        pl.plot(xa[i],y21(xa[i]),c='steelblue',lw=3,label=ll1[0]+','+ll2[i])
    pl.plot(xa[i],dy21(xa[i]),c='darkblue',lw=1,label=ll1[1]+','+ll2[i])
    pl.plot(xa[i],d2y21(xa[i]),c='magenta',lw=1,label=ll1[2]+','+ll2[i])
pl.axvline(0,c='darkred',ls='--',lw=2,label='$x = 0$')
pl.axvline(4,c='red',ls='--',lw=2,label='$x = 4$')
pl.axhline(-3,c='darkorange',ls='--',lw=2,label='$y = -3$')
pl.xlabel(r'$x$',fontsize=15); pl.ylabel(r'$y$',fontsize=15); pl.ylim(-5,5)
pl.legend(fontsize=10,shadow=True,bbox_to_anchor=(.3,1.1)); pl.show()
</script></div><br/>
  <h2>Task 3</h2>
<div class="link1"><script type="text/x-sage"># sage; task 3 (#9.21)
var('x'); y21=(x-2)^(2/3)-(x-3)^(2/3)
y21c=sign(x-2)*(abs(x-2))^(2/3)-sign(x-3)*(abs(x-3))^(2/3)

</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 3

</script></div><br/>
<div class="link1"><script type="text/x-sage"># sage; task 3 

</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 3

</script></div><br/> 
<div class="link1"><script type="text/x-sage"># sage; task 3 

</script></div><br/>
<div class="link2"><script type="text/x-sage"># python; task 3

</script></div><br/>    
   <h2>Cells for Your Experiments</h2>
<div class="sage"><script type="text/x-sage"># sage 
</script></div><br/>
<div class="sage"><script type="text/x-sage"># python / sympy,numpy,pylab
import sympy,numpy,pylab
</script></div><br/>
  </body>
</html>