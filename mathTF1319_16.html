<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Maths_TF1319_16</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function(){
            sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run Detached Cells'});});
    </script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron');
  h1, h2 {color:#3636ff; font-family:'Orbitron'; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:68em;}
      body {margin:5px 5px 5px 15px;}
  </style>  
  <body>
  <h1>&#x1F4D1; &nbsp;Maths. TF1319. Standard Calculation 16</h1>
<a href="https://olgabelitskaya.github.io/README.html">&#x1F300; &nbsp; Home Page &nbsp; &nbsp;</a> &nbsp; &nbsp;
<a href="https://olgabelitskaya.github.io/README_EXERCISES.html">&#x1F300; &nbsp; Various Exam Exercises &nbsp; &nbsp;</a>
Find integrals  
  <h2>Task 1</h2>
<div class="sage"><script type="text/x-sage"># sage; task 1
from sage.symbolic.integration.integral \
import indefinite_integral as ii
set_verbose(-1)
f21(x)=(1+sin(x)^2)*cos(x)/(1+sin(x))^2
intf21(x)=ii(f21(x),x)
s=r'$\displaystyle{f(x)=%s => \int f(x) dx= %s}$'
pretty_print(html(s%(latex(f21(x)),latex(intf21(x)))))
plot([f21(x),intf21(x)],(-3*pi,3*pi),
     detect_poles=True,ymin=-10,ymax=10,
     legend_label='automatic',gridlines=True,
     frame=True,figsize=(7,5))
</script></div><br/>
<div class="sage"><script type="text/x-sage"># python; task 1
import sympy as sp; x=sp.symbols('x')
sp.init_printing(use_unicode=True)
f21=(1+sp.sin(x)^2)*sp.cos(x)/(1+sp.sin(x))^2
intf21=sp.integrate(f21,x).simplify()
display([f21,intf21])
sp.pprint(75*'='); xl=3*sp.pi
col=['#3636ff','#36ff36']
p=sp.plot(f21,(x,-xl,xl),ylim=(-10,10),
          line_color=col[0],show=False)
ip=sp.plot(intf21,(x,-xl,xl),ylim=(-10,10),
           line_color=col[1],show=False)
p.extend(ip); p.show()
</script></div><br/>
  <h2>Task 2</h2>
<div class="sage"><script type="text/x-sage"># sage; task 2
from sage.symbolic.integration.integral \
import indefinite_integral as ii
# f21(x)=(1+cos(x)+3*sin(x))/(sin(x)+1-cos(2*x))
# cos(2*x)=1-2*sin(x)^2
set_verbose(-1)
f21(x)=(1+cos(x)+3*sin(x))/(sin(x)+2*sin(x)^2)
intf21(x)=simplify(ii(f21(x),x))
cintf21(x)=-log(tan(x/2)**2+4*tan(x/2)+1)+\
           2*log(tan(x/2))+\
           ii(-2/(tan(x/2)**2+4*tan(x/2)+1),x)
s=r'$\displaystyle{f(x)=%s => }$'+\
  r'<br/>$\displaystyle{\int f(x) dx= %s}$'+\
  r'<br/>$\displaystyle{cF(x)=%s}$'
pretty_print(html(s%(latex(f21(x)),
                     latex(intf21(x)),
                     latex(cintf21(x)))))
plot([f21(x),intf21(x),cintf21(x)],(-2*pi,2*pi),
     legend_label=['f(x)','F(x)','cF(x)'],frame=True,
     detect_poles=True,ymin=-15,ymax=5,
     gridlines=True,figsize=(7,5))
</script></div><br/>
<div class="sage"><script type="text/x-sage"># python; task 2
import sympy as sp; x,u,v=sp.symbols('x,u,v')
sp.init_printing(use_unicode=True)
f21=(1+sp.cos(x)+3*sp.sin(x))/(sp.sin(x)+2*sp.sin(x)^2)
# cos(x)=(1-u**2)/(1+u**2); sin(x)=2*u/(u**2+1)
# dx=2*du/(u**2+1); f(x)dx=>f(u)du
f21u1=1+sp.cos(x).subs(sp.cos(x),(1-u**2)/(1+u**2))+\
      3*sp.sin(x).subs(sp.sin(x),2*u/(u**2+1))
f21u2=(sp.sin(x)+2*sp.sin(x)^2).subs(sp.sin(x),2*u/(u**2+1))
f21u=(f21u1/f21u2)*2/(u**2+1)
#f21u=(f21u1/f21u2)*2/(u**2+1)+\
#2*(u+1)/(u**2+4*u+1)-2*(u+2)/(u**2+4*u+1)-2/(u**2+4*u+1)
intf21u1=sp.integrate(f21u+2*(u+1)/(u**2+4*u+1),u,manual=True)
intf21u2=sp.integrate(2*(u+2)/(u**2+4*u+1),u,manual=True)
intf21u3=sp.log(-u+sp.sqrt(3)-2)/sp.sqrt(3)-\
         sp.log(u+sp.sqrt(3)+2)/sp.sqrt(3)
intf21u=intf21u1-intf21u2
#u=tan(x/2)
intf21=intf21u.subs(u,sp.tan(x/2))
display([f21,intf21])
sp.pprint(75*'='); xl=2*sp.pi
col=['#3636ff','#36ff36']
p=sp.plot(f21,(x,-xl,xl),ylim=(-15,5),
          line_color=col[0],show=False)
ip=sp.plot(intf21,(x,.01,xl/2-.01),ylim=(-15,5),
           line_color=col[1],show=False)
p.extend(ip); p.show()
</script></div><br/>
  <h2>Task 3</h2>
<div class="sage"><script type="text/x-sage"># sage; task 3 
from sage.symbolic.integration.integral \
import indefinite_integral as ii
set_verbose(-1); f21(x)=cos(4*x)*cos(5*x)
intf21(x)=ii(f21(x),x)
s=r'$\displaystyle{f(x)=%s => }$'+\
  r'<br/>$\displaystyle{\int f(x) dx= %s}$'
pretty_print(html(s%(latex(f21(x)),
                     latex(intf21(x)))))
plot([f21(x),intf21(x)],(-pi,pi),
     legend_label='automatic',frame=True,
     gridlines=True,ymin=-1.2,ymax=1.2,
     figsize=(7,5))
</script></div><br/>
<div class="sage"><script type="text/x-sage"># python; task 3
import sympy as sp; x=sp.symbols('x')
sp.init_printing(use_unicode=True)
f21=sp.cos(4*x)*sp.cos(5*x)
intf21=sp.integrate(f21,x).simplify()
display([f21,intf21])
sp.pprint(75*'='); xl=sp.pi
col=['#3636ff','#36ff36']
p=sp.plot(f21,(x,-xl,xl),ylim=(-1.5,1.5),
          line_color=col[0],show=False)
ip=sp.plot(intf21,(x,-xl,xl),ylim=(-1.5,1.5),
           line_color=col[1],show=False)
p.extend(ip); p.show()
</script></div><br/>
  <h2>Task 4</h2>
<div class="sage"><script type="text/x-sage"># sage; task 4 
from sage.symbolic.integration.integral \
import indefinite_integral as ii
set_verbose(-1); f21(x)=cos(2*x)^4*sin(2*x)^3
intf21(x)=ii(f21(x),x)
s=r'$\displaystyle{f(x)=%s => }$'+\
  r'<br/>$\displaystyle{\int f(x) dx= %s}$'
pretty_print(html(s%(latex(f21(x)),
                     latex(intf21(x)))))
plot([f21(x),intf21(x)],(-pi,pi),
     legend_label='automatic',frame=True,
     gridlines=True,ymin=-.12,ymax=.12,
     figsize=(7,5))
</script></div><br/> 
<div class="sage"><script type="text/x-sage"># python; task 4
import sympy as sp; x=sp.symbols('x')
sp.init_printing(use_unicode=True)
f21=sp.cos(2*x)^4*sp.sin(2*x)^3
intf21=sp.integrate(f21,x).simplify()
display([f21,intf21])
sp.pprint(75*'='); xl=sp.pi
col=['#3636ff','#36ff36']
p=sp.plot(f21,(x,-xl,xl),ylim=(-.15,.15),
          line_color=col[0],show=False)
ip=sp.plot(intf21,(x,-xl,xl),ylim=(-.15,.15),
           line_color=col[1],show=False)
p.extend(ip); p.show()
</script></div><br/>  
   <h2>Cells for Your Experiments</h2>
<div class="sage"><script type="text/x-sage"># sage 
</script></div><br/>
<div class="sage"><script type="text/x-sage"># python / sympy,numpy,pylab
import sympy,numpy,pylab
</script></div><br/>
  </body>
</html>