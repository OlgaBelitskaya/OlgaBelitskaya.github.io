<!DOCTYPE HTML>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width'>
    <title>Instagram_Posts16</title>
    <script src='https://sagecell.sagemath.org/static/embedded_sagecell.js'></script>
    <script>$(function (){
    sagecell.makeSagecell({inputLocation:'div.linked',linked:true,
                           evalButtonText:'Run Linked Cells'});
    sagecell.makeSagecell({inputLocation:'div.sage_html',evalButtonText:'Run HTML'});  
    sagecell.makeSagecell({inputLocation:'div.sage_js',evalButtonText:'Run JavaScript'});
    sagecell.makeSagecell({inputLocation:'div.sage_r',evalButtonText:'Run R'});  
    sagecell.makeSagecell({inputLocation:'div.sage',evalButtonText:'Run SageMath'}); });
    </script>
    <script src='https://d3js.org/d3.v6.min.js'></script>
  </head>
  <style>
  @import 'https://fonts.googleapis.com/css?family=Orbitron';
  h1,h2 {color:#3636ff; font-family:Orbitron; text-shadow:5px 5px 5px #aaa;}
  p,a {color:darkblue; font-size:120%; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:30em;}
  body {margin:5px 5px 5px 15px;}
  </style>  
  <body>
<script src='https://profile.codersrank.io/widget/widget.js'></script>
<codersrank-widget username='olgabelitskaya' layout='vertical'
style='--header-bg-color:#3636ff; font-family:Orbitron;'></codersrank-widget>
    <h1>&#x1F4D1; &nbsp;Instagram Posts. Part 16</h1>
<a href='https://olgabelitskaya.github.io/README.html'>&#x1F300; &nbsp; Home Page &nbsp; &nbsp;</a> 
<a href='https://olgabelitskaya.github.io/instagram13.html'>&#x1F300; &nbsp; Previous &nbsp; &nbsp;</a><br/>
<a href='https://www.instagram.com/olga.belitskaya/'>&#x1F300; &nbsp; Instagram Posts &nbsp; &nbsp;</a>     
<a href='https://www.pinterest.ru/olga_belitskaya/code-style/'>&#x1F300; &nbsp; Pinterest Posts</a>
    <h1>____</h1>
SageMath <br/>
<div class='sage'><script type='text/x-sage'>

</script></div><br/>
    <h1>____</h1>
SageMath <br/>
<div class='sage'><script type='text/x-sage'>

</script></div><br/>
    <h1>____</h1>
SageMath <br/>
<div class='sage'><script type='text/x-sage'>

</script></div><br/>
    <h1>_____</h1>
Linked Cells & Python<br/>
<div class='linked'><script type='text/x-sage'>

</script></div><br/>
<div class='linked'><script type='text/x-sage'>

</script></div><br/>
<div class='linked'><script type='text/x-sage'>

</script></div><br/>
    <h1>Styling in Printing</h1>
Python <br/>
<div class='sage'><script type='text/x-sage'>
from IPython.display import display,HTML
import random
def idhtml(string,fontcolor='darkslategray',
           font='Ewert',fontsize=24):
    randi=random.randint(1,999999999)
    style_str="""<style>@import """+\
    """'https://fonts.googleapis.com/css?family="""+font+\
    """'; #colored_font"""+str(randi)+\
    """ {color:"""+fontcolor+\
    """; font-family:"""+font+\
    """; font-size:"""+str(fontsize)+"""px;}</style>"""
    h_str="""<h1 id='colored_font"""+str(randi)+\
    """'>"""+string+"""</h1>"""
    script_str="""<script>"""+\
    """var idc=setInterval(function() {"""+\
    """var iddoc=document.getElementById("""+\
    """'colored_font"""+str(randi)+"""'); """+\
    """var now=new Date().getTime(); """+\
    """var sec=Math.floor((now%(1000*60))/1000); """+\
    """var col='rgb('+(5+Math.abs(245-8*sec))+',0,'"""+\
    """+(250-Math.abs(245-8*sec))+')'; """+\
    """iddoc.style.color=col;},1000);</"""+"""script>"""
    display(HTML(style_str+h_str+script_str))
idhtml('Styling in Printing')
</script></div><br/>
    <h1>____</h1>
Python <br/>
<div class='sage'><script type='text/x-sage'>

</script></div><br/>
      <h1>Aggregate CSV</h1>
R <br/>
<div class='sage_r'><script type='text/x-sage'>
%%r
mean_aggr_csv<-function(url,sep,column,group_by) {
    df<-read.csv(url,header=TRUE,sep=sep)
    len<-dim(df)[1]
    group_list<-list(df[1:len,group_by])
    result<-aggregate(df[column],group_list,mean)
    colnames(result)<-c(group_by,paste0('mean ',column))
    return(result)}
median_aggr_csv<-function(url,sep,column,group_by) {
    df<-read.csv(url,header=TRUE,sep=sep)
    len<-dim(df)[1]
    group_list<-list(df[1:len,group_by])
    result<-aggregate(df[column],group_list,median)
    colnames(result)<-c(group_by,paste0('median ',column))
    return(result)}
sum_aggr_csv<-function(url,sep,column,group_by) {
    df<-read.csv(url,header=TRUE,sep=sep)
    len<-dim(df)[1]
    group_list<-list(df[1:len,group_by])
    result<-aggregate(df[column],group_list,sum) 
    colnames(result)<-c(group_by,paste0('sum ',column))
    return(result)}
url<-'https://olgabelitskaya.github.io/huge_cities.tsv'
sep='\t'; column<-'growth'; group_by<-'country'
mean_aggr_csv(url,sep,column,group_by)
</script></div><br/>
      <h1>_____</h1>
R <br/>
<div class='sage_r'><script type='text/x-sage'>
%%r

</script></div><br/>
      <h1>Recursive Curves</h1>
<p>&#60;script src='https://d3js.org/d3.v6.min.js'>&#60;/script> 
    was added in the page head.</p>
<div class='sage_html'><script type='text/x-sage'>
%%html
n <input type='number' id='n_frames' value=1
style='width:160px; font-size:120%; color:#363636;
background-color:silver; text-align:center;'/> 
m <input type='number' id='m_frames' value=15
style='width:160px; font-size:120%; color:#363636;
background-color:silver; text-align:center;'/>
run =>>> <input type='button' onclick='draw_curves();' value='update'
style='width:160px; font-size:120%; color:#363636;
background-color:silver; text-align:center;'/><br/><br/>
<svg id='d301' style='background-color:silver;'/>
<script>
s=600;
colors=['#3636ff','#ff3636','#ff36ff',
        '#ffff36','#36ff36','#36ffff'];
function subpoint(a,b,m) {
  return [Math.floor(m/2)*(a[0]+b[0])/m,
          Math.floor(m/2)*(a[1]+b[1])/m]};
function subdivpoly(poly,m,iterations=1) {
  var [p1,p2,p3]=poly,points=[];
  var centroid=d3.polygonCentroid(poly);
  if (iterations===0) {points.push(centroid);} 
  else {var subset1=[p1,subpoint(p1,p3,m),p2],
            subset2=[p2,subpoint(p1,p3,m),p3];
        points.push(...subdivpoly(subset1,m,iterations-1));
        points.push(...subdivpoly(subset2,m,iterations-1));}
  return points};
function recursive_curve(len,m,iterations) {
  var contour1=[[0,len],[0,0],[len,0]],
      contour2=[[len,0],[len,len],[0,len]];
  var half1=subdivpoly(contour1,m,iterations),
      half2=subdivpoly(contour2,m,iterations);
  return [...half1,...half2];};
function draw_curves() {
  var m=parseInt(document.getElementById('m_frames').value);
  var n=parseInt(document.getElementById('n_frames').value);
  var line=d3.line();
  var svg=d3.select('#d301').attr('width',s).attr('height',s);
  svg.selectAll('path').remove();
  svg.selectAll('.curve').data(colors).join('path')
     .attr('d',(_,i)=>line(recursive_curve(s,m,i+n))+'z')
     .style('fill',d=>d).style('fill-opacity',.02)
     .style('stroke',d=>d).style('stroke-width',2); };
</script></div><br/>
      <h1>Animated Lines</h1>
<p>&#60;script src='https://d3js.org/d3.v6.min.js'>&#60;/script> 
    was added in the page head.</p>
<div class='sage_html'><script type='text/x-sage'>
%%html
number <select id='num_points' 
style='text-align:center; text-align-last:center; 
  background:silver; width:200px; height:25px'>
    <option value='100'>100</option><option value='150'>150</option>
    <option value='200'>200</option><option value='250'>250</option>
    <option value='300'>300</option><option value='350'>350</option>
</select><br/><br/>run &nbsp; &nbsp; &nbsp; &nbsp;
<button style='background:silver; width:200px; height:25px'
onclick='draw_chart();' id='run_button'>=>>></button><br/><br/>
<svg id='d302' style='background-color:silver;'/><script>
margin={top:20,right:20,bottom:20,left:60},width=600,height=400;
reveal=path=>
path.transition().duration(10000).ease(d3.easeLinear)
    .attrTween('stroke-dasharray',function() {
      const length=this.getTotalLength();
      return d3.interpolate(`0,${length}`,`${length},${length}`);});
function draw_chart() {
  var n=parseInt(document.getElementById('num_points').value);
  var x=d3.scaleLinear().domain([0,n-1])
          .range([margin.left,width-margin.right]),
      y=d3.scaleLinear().domain([0,n])
          .range([height-margin.bottom,margin.top]); 
  var line=d3.line().curve(d3.curveMonotoneX)
           .x(function(d,i) {return x(i);})
           .y(function(d) {return y(d.y);});
  var data=d3.range(n).map(function(d) {
      return {'y':d3.randomUniform(n)()}; })
  var xAxis=(g,scale=x)=>g
      .attr('transform',`translate(0,${height-margin.bottom})`)
      .call(d3.axisBottom(scale)
              .ticks(width/60).tickSizeOuter(0)),
      yAxis=(g,scale=y)=>g
      .attr('transform',`translate(${margin.left},0)`)
      .call(d3.axisLeft(scale).ticks(height/40));
  var svg=d3.select('#d302')
            .attr('width',width).attr('height',height);
  svg.selectAll('g').remove(); svg.selectAll('path').remove();
  svg.append('g').call(xAxis); svg.append('g').call(yAxis);
  svg.append('path').datum(data).attr('d',line)
     .attr('stroke','#ff36ff').attr('stroke-width',1)
     .attr('stroke-miterlimit',1).attr('stroke-dasharray','0,1')
     .attr('fill','none').call(reveal);};
</script></div><br/>
      <h1>Color Gradient & Canvas Text</h1>
<div class='sage_html'><script type='text/x-sage'>
%%html
<canvas id='canvas001' width='280' height='60'></canvas>
<script>
var c=document.getElementById('canvas001'); 
var context=c.getContext('2d');
context.font='18px Verdana';
var gradient=context.createLinearGradient(0,0,280,0);
gradient.addColorStop('0','#3636ff');
gradient.addColorStop('.5','#ff36ff');
gradient.addColorStop('1.','#ff3636');
context.strokeStyle=gradient;
context.strokeText('color gradient & canvas text',10,40)
</script></div><br/>
  </body>
</html>